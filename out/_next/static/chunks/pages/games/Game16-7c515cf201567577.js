(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[805],{55971:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/games/Game16",function(){return n(16373)}])},16373:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>j});var s=n(85893),r=n(67294),o=n(45281),c=n(84283),a=n(53637),i=n(39886),l=n(54610),d=n(84082),u=n(49816),m=n(87261),p=n(89163),h=n(74855),f=n(44173),y=n(52802);let b=JSON.parse('[{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"Count","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"receiver","type":"address"},{"internalType":"uint256","name":"ticketAmount","type":"uint256"}],"name":"claimTickets","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"maxTicketsPerAddress","outputs":[{"internalType":"uint8","name":"","type":"uint8"}],"stateMutability":"view","type":"function"}]'),g=JSON.parse('[{"inputs":[{"internalType":"address","name":"_target","type":"address"},{"internalType":"address","name":"attacker","type":"address"},{"internalType":"uint256","name":"ticketAmount","type":"uint256"}],"name":"attack","outputs":[],"stateMutability":"nonpayable","type":"function"}]');var x=n(72771);n(18384);let j=()=>{let[e,t]=(0,r.useState)(""),[n,j]=(0,r.useState)(""),[k,v]=(0,r.useState)(""),[w,C]=(0,r.useState)(""),[N,O]=(0,r.useState)(""),[T,S]=(0,r.useState)(!1),Z=(0,r.useRef)(null),{walletAddress:A,factoryContract:P,nftContract:_,web3:M}=(0,r.useContext)(x.S),[E,R]=(0,r.useState)(null),[I,z]=(0,r.useState)(null),[L,H]=(0,r.useState)(""),[G,D]=(0,r.useState)(0),[Y,B]=(0,r.useState)(!1),[F,X]=(0,r.useState)(""),[J,V]=(0,r.useState)(""),[W,q]=(0,r.useState)(""),[K,Q]=(0,r.useState)(""),[U,$]=(0,r.useState)("");(0,r.useEffect)(()=>{M&&M.utils.isAddress(k)&&M.utils.isAddress(w)&&(R(new M.eth.Contract(b,k)),z(new M.eth.Contract(g,w)))},[k,w]),(0,r.useEffect)(()=>{(async()=>{A&&_&&(O(await _.methods.balanceOf(A,16).call()),console.log(N))})()},[A,_,N]);let ee=async()=>{try{S(!0);let e=await P.methods.deploy(16).send({from:A});e.events.DeployInstance?(console.log(e),console.log(M.utils.toChecksumAddress("0x".concat(e.logs[0].topics[1].slice(-40)))),console.log(M.utils.toChecksumAddress("0x".concat(e.logs[1].topics[1].slice(-40)))),v(M.utils.toChecksumAddress("0x".concat(e.logs[0].topics[1].slice(-40)))),C(M.utils.toChecksumAddress("0x".concat(e.logs[1].topics[1].slice(-40)))),f.Am.success("Game created successfully!")):f.Am.error("Game creation failed."),S(!1)}catch(e){S(!1),console.log(e),f.Am.error("Game creation failed. Please make sure your Metamask wallet is properly connected.")}},et=async(e,t)=>{if(E)try{await E.methods.claimTickets(e,t).send({from:A}).then(async()=>{f.Am.success("Claiming was completed successfully!")})}catch(e){console.error(e.message),f.Am.error("Transaction failed.")}},en=async()=>{try{let e=Number(await E.methods.Count(J).call());X(e),console.log(e)}catch(e){console.error(e),f.Am.error("Failed to get Count.")}},es=async()=>{let e=Number(await E.methods.maxTicketsPerAddress().call());H(e),console.log(e)},er=async(e,t,n)=>{if(E)try{await I.methods.attack(e,t,n).send({from:A}).then(async()=>{let e=await E.methods.Count(A).call();D(e),f.Am.success("Claiming was completed successfully! You have ".concat(Number(G)+Number(n)," tickets."))})}catch(e){console.error(e.message),f.Am.error("Transaction failed.")}},eo=async()=>{let e=await E.methods.Count(A).call();if(console.log(e),D(e),G>3){if(console.log("The Mission Is Complete"),(0,f.Am)("Well done! You have solved this level!",{autoClose:5e3}),N<1)try{await _.methods.mint(16,k).send({from:A}).once("error",e=>{console.log(e),f.Am.error("Minting failed.")}).once("receipt",async()=>{let e=await _.methods.balanceOf(A,16).call();O(e),console.log(e),f.Am.success("Minting completed successfully!")})}catch(e){console.error(e.message),f.Am.error("Minting failed.")}}else f.Am.error("You don't have enough tickets.")},ec='\n  // SPDX-License-Identifier: MIT\n\n  pragma solidity ^0.8.10;\n  \n  contract LimitedTickets {\n  \n      mapping(address => uint256) public Count;\n      uint8 public maxTicketsPerAddress = 3;\n  \n      function claimTickets(address receiver, uint256 ticketAmount) public {\n          require(\n              Count[msg.sender] + ticketAmount <= maxTicketsPerAddress,\n              "max tickets per address exceeded"\n          );\n          for (uint256 i = 0; i < ticketAmount; i++) {\n              Count[receiver]++;\n          }\n      }\n  }\n  \n  contract HacklimitedTickets {\n      LimitedTickets target;\n  \n      function attack(address _target ,address attacker, uint256 ticketAmount) public {\n          target = LimitedTickets(_target);\n          target.claimTickets(attacker,ticketAmount);\n      }\n  }\n  ';return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(a.Z,{className:"bg-primary-black overflow-hidden",children:[(0,s.jsx)(y.wp,{}),(0,s.jsx)("h1",{className:"game-title title-color",children:(0,s.jsx)("b",{children:"Limited Tickets"})}),(0,s.jsx)(i.Z,{className:"card",style:{backgroundColor:"#000000",color:"white"},children:(0,s.jsx)(l.Z,{children:(0,s.jsxs)("div",{className:"code-section",children:[(0,s.jsx)(h.CopyToClipboard,{text:ec,children:(0,s.jsx)(d.Z,{className:"button-copy",children:"Copy code"})}),(0,s.jsx)(o.Z,{language:"javascript",style:c.Vg,ref:Z,children:ec})]})})}),(0,s.jsx)(i.Z,{className:"game-card card-color",style:{backgroundColor:"#000000",color:"white"},children:(0,s.jsxs)(l.Z,{children:[(0,s.jsx)(u.Z,{className:"desc-title title-color",children:(0,s.jsx)("b",{children:"Game Description"})}),(0,s.jsxs)("p",{children:[(0,s.jsx)("b",{children:"Strategize and bypass ticket limitations in Solidity. Challenge the system and claim rewards. "}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsxs)("b",{children:[(0,s.jsx)("strong",{children:" You need:"})," To play this game, you must creatively explore communication with the ticketing contract, understanding how to potentially bypass a limitation that restricts users to three tickets. Familiarity with intermediate contracts could prove valuable."]})]}),(0,s.jsx)("div",{children:(0,s.jsx)(d.Z,{style:{backgroundColor:"#c97539",color:"white"},className:"button-margin",onClick:ee,children:"Create Instance"})})]})}),!T&&""!==k&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.Z,{className:"game-card",style:{backgroundColor:"#000000",color:"white"},children:(0,s.jsxs)(l.Z,{children:[(0,s.jsxs)("h3",{className:"mt-1 title-color",children:["LimitedTickets Address: ",(0,s.jsxs)("p",{className:"Instance-color",children:[" ",k," "]})]}),(0,s.jsxs)("h3",{className:"mt-1 title-color",children:["HacklimitedTickets Address: ",(0,s.jsxs)("p",{className:"Instance-color",children:[" ",w," "]})]})]})}),(0,s.jsx)(i.Z,{className:"game-card",style:{backgroundColor:"#000000",color:"white"},children:(0,s.jsxs)(l.Z,{children:[(0,s.jsx)(u.Z,{className:"desc-title title-color",children:(0,s.jsx)("b",{children:"Limited Tickets"})}),(0,s.jsx)(m.Z,{style:{color:"black"},className:"form-control-alternative",id:"input-city",placeholder:"address",type:"text",onChange:e=>V(e.target.value)}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,s.jsx)(d.Z,{style:{backgroundColor:"#355f7d",color:"white"},className:"mt-1",onClick:()=>en(F),children:"Count"}),F&&(0,s.jsx)("p",{style:{marginLeft:"10px",wordBreak:"break-all"},children:F})]}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",minHeight:"50px"},children:[(0,s.jsx)(d.Z,{className:"mt-1",onClick:()=>es(),style:{backgroundColor:"#355f7d",color:"white"},children:"maxTicketsPerAddress"}),""!==L&&(0,s.jsx)("p",{style:{marginLeft:"10px"},children:L})]}),(0,s.jsx)("br",{}),(0,s.jsxs)(p.Z,{children:[(0,s.jsx)(m.Z,{style:{color:"black"},className:"form-control-alternative",id:"input-city",placeholder:"Receiver",type:"text",onChange:e=>t(e.target.value)}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)(m.Z,{style:{color:"black"},className:"form-control-alternative",id:"input-city",placeholder:"TicketAmount",type:"text",onChange:e=>j(e.target.value)})]}),(0,s.jsx)("br",{}),(0,s.jsx)(d.Z,{style:{backgroundColor:"#c97539",color:"white"},className:"mt-1",onClick:()=>et(e,n),children:"claimTickets"})]})}),(0,s.jsx)(i.Z,{className:"game-card",style:{backgroundColor:"#000000",color:"white"},children:(0,s.jsxs)(l.Z,{children:[(0,s.jsx)(u.Z,{className:"card-title desc-title title-color",style:{color:"red"},children:(0,s.jsx)("b",{children:"Hack limitedTickets"})}),(0,s.jsxs)(p.Z,{children:[(0,s.jsx)(m.Z,{style:{color:"black"},className:"form-control-alternative",id:"input-city",placeholder:"_target",type:"text",onChange:e=>q(e.target.value)}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)(m.Z,{style:{color:"black"},className:"form-control-alternative",id:"input-city",placeholder:"attacker",type:"text",onChange:e=>Q(e.target.value)}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)(m.Z,{style:{color:"black"},className:"form-control-alternative",id:"input-city",placeholder:"ticketAmount",type:"text",onChange:e=>$(e.target.value)})]}),(0,s.jsx)("br",{}),(0,s.jsx)(d.Z,{style:{backgroundColor:"#c97539",color:"white"},className:"mt-1",onClick:()=>er(W,K,U),children:"attack"}),(0,s.jsx)("br",{})," ",(0,s.jsx)("br",{}),(0,s.jsx)(d.Z,{style:{backgroundColor:"#355f7d",color:"white"},className:"mt-1",onClick:()=>{B(!Y)},children:Y?"Hide Hint":"Show Hint"}),Y&&(0,s.jsx)(i.Z,{className:"card",style:{backgroundColor:"#000000",color:"white"},children:(0,s.jsxs)(l.Z,{children:[(0,s.jsx)(u.Z,{className:"desc-title title-color",children:(0,s.jsx)("b",{children:"Hint"})}),(0,s.jsx)("p",{children:"Consider how the 'claimTickets' function tracks ticket count. When the attacker contract calls this function, it's defined as the msg.sender. Even though the tickets are transferred to your address through the attacker contract, the balance of the attacker contract will always remain at zero tickets."})]})})]})}),(0,s.jsx)(i.Z,{className:"card",style:{backgroundColor:"#000000",color:"white"},children:(0,s.jsx)(l.Z,{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:(0,s.jsx)(d.Z,{style:{backgroundColor:"#c97539",color:"white"},className:"button",onClick:eo,children:"Submit"})})})]}),(0,s.jsx)("p",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:N<1?null:(0,s.jsxs)("div",{children:[(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsxs)("strong",{children:["Congratulations! You Got A Badge"," ",(0,s.jsx)("i",{className:"fas fa-medal",style:{color:"gold",fontSize:"20px",position:"relative",top:"3px"}})]}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{})]})})]}),(0,s.jsx)(f.Ix,{})]})}},89163:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var s=n(67294),r=n(45697),o=n.n(r),c=n(93967),a=n.n(c),i=n(22040),l=["className","cssModule","row","disabled","check","inline","floating","noMargin","tag","switch"];function d(){return(d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e}).apply(this,arguments)}var u={children:o().node,row:o().bool,check:o().bool,switch:o().bool,inline:o().bool,floating:o().bool,noMargin:o().bool,disabled:o().bool,tag:i.iC,className:o().string,cssModule:o().object};function m(e){var t=e.className,n=e.cssModule,r=e.row,o=e.disabled,c=e.check,u=e.inline,m=e.floating,p=e.noMargin,h=e.tag,f=void 0===h?"div":h,y=e.switch,b=function(e,t){if(null==e)return{};var n,s,r=function(e,t){if(null==e)return{};var n,s,r={},o=Object.keys(e);for(s=0;s<o.length;s++)n=o[s],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(e,l),g=c||y,x=(0,i.mx)(a()(t,!!r&&"row",!!g&&"form-check",!!y&&"form-switch",!g&&!p&&"mb-3",!!g&&!!u&&"form-check-inline",!!g&&!!o&&"disabled",m&&"form-floating"),n);return"fieldset"===f&&(b.disabled=o),s.createElement(f,d({},b,{className:x}))}m.propTypes=u;let p=m},87261:(e,t,n)=>{"use strict";n.d(t,{Z:()=>b});var s=n(67294),r=n(45697),o=n.n(r),c=n(93967),a=n.n(c),i=n(22040);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var d=["className","cssModule","type","bsSize","valid","invalid","tag","addon","plaintext","innerRef"];function u(){return(u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e}).apply(this,arguments)}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f={children:o().node,type:o().string,size:o().oneOfType([o().number,o().string]),bsSize:o().string,valid:o().bool,invalid:o().bool,tag:i.iC,innerRef:o().oneOfType([o().object,o().func,o().string]),plaintext:o().bool,addon:o().bool,className:o().string,cssModule:o().object},y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(o,e);var t,n,r=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=h(o);return e=t?Reflect.construct(n,arguments,h(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return p(e)}(this,e)});function o(e){var t;return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).getRef=t.getRef.bind(p(t)),t.focus=t.focus.bind(p(t)),t}return n=[{key:"getRef",value:function(e){this.props.innerRef&&this.props.innerRef(e),this.ref=e}},{key:"focus",value:function(){this.ref&&this.ref.focus()}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.cssModule,r=e.type,o=void 0===r?"text":r,c=e.bsSize,l=e.valid,m=e.invalid,p=e.tag,h=e.addon,f=e.plaintext,y=e.innerRef,b=function(e,t){if(null==e)return{};var n,s,r=function(e,t){if(null==e)return{};var n,s,r={},o=Object.keys(e);for(s=0;s<o.length;s++)n=o[s],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(e,d),g=["switch","radio","checkbox"].indexOf(o)>-1,x="textarea"===o,j="select"===o,k="range"===o,v=p||(j||x?o:"input"),w="form-control";f?(w="".concat(w,"-plaintext"),v=p||"input"):k?w="form-range":j?w="form-select":g&&(w=h?null:"form-check-input"),b.size&&/\D/g.test(b.size)&&((0,i.O4)('Please use the prop "bsSize" instead of the "size" to bootstrap\'s input sizing.'),c=b.size,delete b.size);var C=(0,i.mx)(a()(t,m&&"is-invalid",l&&"is-valid",!!c&&(j?"form-select-".concat(c):"form-control-".concat(c)),w),n);return("input"===v||p&&"function"==typeof p)&&(b.type="switch"===o?"checkbox":o),b.children&&!(f||"select"===o||"string"!=typeof v||"select"===v)&&((0,i.O4)('Input with a type of "'.concat(o,'" cannot have children. Please use "value"/"defaultValue" instead.')),delete b.children),s.createElement(v,u({},b,{ref:y,className:C,"aria-invalid":m}))}}],function(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}(o.prototype,n),Object.defineProperty(o,"prototype",{writable:!1}),o}(s.Component);y.propTypes=f;let b=y}},e=>{var t=t=>e(e.s=t);e.O(0,[817,956,802,888,774,179],()=>t(55971)),_N_E=e.O()}]);